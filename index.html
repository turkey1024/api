<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>随机用户数据展示</title>
</head>
<body>
    <button id="toggleRefreshBtn">暂停自动刷新</button>
    <div id="userData">
        <p>正在加载用户数据...</p>
    </div>

    <script>
        let refreshInterval;
        let isAutoRefresh = true;
        const userDataElement = document.getElementById('userData');
        const toggleRefreshBtn = document.getElementById('toggleRefreshBtn');
        
        // 页面加载完成后开始自动刷新
        window.onload = function() {
            startAutoRefresh();
        };
        
        // 开始/停止自动刷新
        function toggleAutoRefresh() {
            if(isAutoRefresh) {
                clearInterval(refreshInterval);
                toggleRefreshBtn.textContent = '继续自动刷新';
                isAutoRefresh = false;
            } else {
                startAutoRefresh();
                toggleRefreshBtn.textContent = '暂停自动刷新';
                isAutoRefresh = true;
            }
        }
        
        // 开始自动刷新
        function startAutoRefresh() {
            // 立即获取一次数据
            fetchRandomUser();
            // 设置每5秒自动刷新
            refreshInterval = setInterval(fetchRandomUser, 5000);
        }
        
        // 获取随机用户数据
        function fetchRandomUser() {
            userDataElement.innerHTML = '<p>正在加载用户数据...</p>';
            
            fetch('https://randomuser.me/api/')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('网络响应不正常');
                    }
                    return response.json();
                })
                .then(data => {
                    const user = data.results[0];
                    // 解析并格式化显示用户数据
                    displayUserData(user);
                })
                .catch(error => {
                    userDataElement.innerHTML = `<p style="color: red;">加载失败: ${error.message}</p>`;
                    // 如果是自动刷新模式，3秒后重试
                    if(isAutoRefresh) {
                        setTimeout(fetchRandomUser, 3000);
                    }
                });
        }
        
        // 格式化显示用户数据
        function displayUserData(user) {
            userDataElement.innerHTML = `
                <div>
                    <img src="${user.picture.large}" alt="用户头像" style="max-width: 200px;">
                    <h2>${user.name.title} ${user.name.first} ${user.name.last}</h2>
                    <div>
                        <h3>基本信息</h3>
                        <p><strong>性别：</strong>${user.gender}</p>
                        <p><strong>年龄：</strong>${user.dob.age}</p>
                        <p><strong>出生日期：</strong>${new Date(user.dob.date).toLocaleDateString()}</p>
                        <p><strong>注册时间：</strong>${new Date(user.registered.date).toLocaleDateString()}</p>
                        
                        <h3>联系信息</h3>
                        <p><strong>邮箱：</strong>${user.email}</p>
                        <p><strong>电话：</strong>${user.phone}</p>
                        <p><strong>手机：</strong>${user.cell}</p>
                        
                        <h3>地址信息</h3>
                        <p><strong>国家：</strong>${user.location.country}</p>
                        <p><strong>城市：</strong>${user.location.city}</p>
                        <p><strong>街道：</strong>${user.location.street.name} ${user.location.street.number}</p>
                        <p><strong>邮编：</strong>${user.location.postcode}</p>
                        
                        <h3>登录信息</h3>
                        <p><strong>用户名：</strong>${user.login.username}</p>
                        <p><strong>密码：</strong>${user.login.password}</p>
                    </div>
                </div>
            `;
        }
        
        // 绑定按钮点击事件
        toggleRefreshBtn.addEventListener('click', toggleAutoRefresh);
    </script>
</body>
</html>

